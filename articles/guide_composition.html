<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>A guide to guide composition • legendry</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A guide to guide composition">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">legendry</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/gallery.html">Example Gallery</a></li>
    <li><a class="dropdown-item" href="../articles/guide_composition.html">A guide to guide composition</a></li>
    <li><a class="dropdown-item" href="../articles/keys.html">Key information</a></li>
    <li><a class="dropdown-item" href="../articles/tour.html">A guided tour</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://teunbrand.github.io/teunbrand_blog/posts/2024-11-01-legendry-0-1-0/">Version 0.1.0: Moltres</a></li>
    <li><a class="external-link dropdown-item" href="https://teunbrand.github.io/teunbrand_blog/posts/2024-12-14-legendry-0-2-0/">Version 0.2.0: Zapdos</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/teunbrand/legendry/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>A guide to guide composition</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/teunbrand/legendry/blob/main/vignettes/articles/guide_composition.Rmd" class="external-link"><code>vignettes/articles/guide_composition.Rmd</code></a></small>
      <div class="d-none name"><code>guide_composition.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://teunbrand.github.io/legendry/">legendry</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span></code></pre></div>
<p>The expert’s eye may have noticed that not all exported functionality
are full blown <a href="https://teunbrand.github.io/legendry/articles/tour.html">guides</a>
or <a href="https://teunbrand.github.io/legendry/articles/keys.html">key
constructors</a>. Besides aforementioned important components, let’s
talk a bit about the innards of guides.</p>
<div class="section level2">
<h2 id="stacking">Stacking<a class="anchor" aria-label="anchor" href="#stacking"></a>
</h2>
<p>When we cut open a guide and examine its innards spilling out, our
eyes first meets the skeleton that holds the guide together. This
skeleton is the composition guide: a guide whose task it is to render
and compose other guides. The composition guide may not be entirely
foreign to a ggplot2-user. This is because vanilla ggplot2 also contains
a composition guide, namely <code><a href="https://ggplot2.tidyverse.org/reference/guide_axis_stack.html" class="external-link">guide_axis_stack()</a></code>. It accepts
as it input some guide specifications and stacks the guides on top of
one another.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Engine displacement (litres)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Highway Miles per Gallon"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">standard</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_axis_stack.html" class="external-link">guide_axis_stack</a></span><span class="op">(</span><span class="st">"axis"</span>, <span class="st">"axis"</span>, <span class="st">"axis"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>In legendry, we have the same composition operation:
<code><a href="../reference/compose_stack.html">compose_stack()</a></code>. For your regular axis guides for the
<code>x</code> and <code>y</code> aesthetics, it works the same way as
<code><a href="https://ggplot2.tidyverse.org/reference/guide_axis_stack.html" class="external-link">guide_axis_stack()</a></code>. However, if the guides it stacks
supports other aesthetics, like <code>colour</code>, it can also be used
there.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">staxis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compose_stack.html">compose_stack</a></span><span class="op">(</span><span class="st">"axis_base"</span>, <span class="st">"axis_base"</span>, <span class="st">"axis_base"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">standard</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">cty</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">staxis</span>,</span>
<span>    colour <span class="op">=</span> <span class="fu"><a href="../reference/guide_colbar.html">guide_colbar</a></span><span class="op">(</span>first_guide <span class="op">=</span> <span class="va">staxis</span>, second_guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="primitives">Primitives<a class="anchor" aria-label="anchor" href="#primitives"></a>
</h2>
<p>At this point, it might be wise to take a closer look at exactly what
<code><a href="../reference/guide_axis_base.html">guide_axis_base()</a></code> is doing. Once we pull on the threads on
what its class is, the mystery starts to unravel:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="fu"><a href="../reference/guide_axis_base.html">guide_axis_base</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ComposeStack" "Compose"      "Guide"        "ggproto"      "gg"</span></span></code></pre></div>
<p>Indeed, by using
<code>compose_stack("axis_base", "axis_base", ...)</code> we have been
stacking a stack! So when we peel back the layers and see what is inside
<code><a href="../reference/guide_axis_base.html">guide_axis_base()</a></code>, will we find more stacks? No: all good
things must come to an end and so too must guides have their building
blocks.</p>
<p>If the composition is the skeleton then these building blocks are the
flesh providing function. These building blocks are called ‘primitives’
in legendry. For example, the <code><a href="../reference/guide_axis_base.html">guide_axis_base()</a></code> function is
a stack of three primitives. They respectively build the axis line, the
ticks and the labels. In the complete guide, they don’t have any spacing
between them, but let’s exaggerate the spacing for clarity.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standard</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="../reference/compose_stack.html">compose_stack</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/primitive_line.html">primitive_line</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/primitive_ticks.html">primitive_ticks</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/primitive_labels.html">primitive_labels</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    theme <span class="op">=</span> <span class="fu"><a href="../reference/theme_guide.html">theme_guide</a></span><span class="op">(</span>spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="section level3">
<h3 id="introducing-the-rest-of-the-family">Introducing the rest of the family<a class="anchor" aria-label="anchor" href="#introducing-the-rest-of-the-family"></a>
</h3>
<p>We’ve already met the more ‘famous’ primitives (lines, ticks,
labels), so let’s round out our acquaintances. There is a spacer
primitive that you can use to increase the spacing between the different
pancakes in the stack, as it were. Then there is also the ‘ranged’
triplet: brackets, boxes and fences. These require a more niche <a href="https://teunbrand.github.io/legendry/articles/keys.html#ranged-keys">range
key</a> and power the display of <a href="https://teunbrand.github.io/legendry/articles/tour.html#nested-axes">nested
axes</a>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">range_key</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/key_range.html">key_range_manual</a></span><span class="op">(</span></span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, </span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"First"</span>, <span class="st">"Second"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">standard</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="../reference/compose_stack.html">compose_stack</a></span><span class="op">(</span></span>
<span>  <span class="st">"axis_base"</span>,</span>
<span>  <span class="fu"><a href="../reference/primitive_bracket.html">primitive_bracket</a></span><span class="op">(</span><span class="va">range_key</span>, <span class="st">"curvy"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/primitive_spacer.html">primitive_spacer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/primitive_box.html">primitive_box</a></span><span class="op">(</span><span class="va">range_key</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/primitive_spacer.html">primitive_spacer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/primitive_fence.html">primitive_fence</a></span><span class="op">(</span><span class="va">range_key</span>, rail <span class="op">=</span> <span class="st">"outer"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The last member of the family is <code><a href="../reference/primitive_title.html">primitive_title()</a></code>.
Aside from just displaying text, it does three things:</p>
<ol style="list-style-type: decimal">
<li>If we have &gt;1 title, it will distribute the titles along the
range. This makes it more convenient to label the lower and higher ends
of a scale.</li>
<li>It ‘absorbs’ the regular axis title by turning it off. Because the
title primitive is a guide and not the actual title, this makes it
slightly easier to prevent unwanted double titles.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standard</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="fu"><a href="../reference/compose_stack.html">compose_stack</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/primitive_title.html">primitive_title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Sneaky little displacementses"</span>, </span>
<span>    <span class="st">"We needs it. Must have the displament"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/primitive_title.html">primitive_title</a></span><span class="op">(</span><span class="st">"Gollum explains engine displacement to you"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"A normal person explains engine displacement"</span><span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<ol start="3" style="list-style-type: decimal">
<li>As it is implemented as a guide, it cannot take the place of regular
axis titles. This also means that the titles will repeat over
facets.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/last_plot.html" class="external-link">last_plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">year</span><span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="dont-use-primitives-directly">Don’t use primitives directly<a class="anchor" aria-label="anchor" href="#dont-use-primitives-directly"></a>
</h3>
<p>By giving them the <code>primitive_</code>-prefix, we have made it
impossible to use them by name inside function that don’t expect them.
This acts as a little bit of discouragement from using primitives as
complete guides.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standard</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>x.sec <span class="op">=</span> <span class="st">"ticks"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `validate_guide()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Unknown guide: ticks</span></span></code></pre></div>
<p>However, you <em>can</em> use primitives by name inside guide
composition functions, <em>or</em> use their full constructor
function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standard</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>x.sec <span class="op">=</span> <span class="fu"><a href="../reference/compose_stack.html">compose_stack</a></span><span class="op">(</span><span class="st">"ticks"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Looks identical to the above</span></span>
<span><span class="va">standard</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>x.sec <span class="op">=</span> <span class="fu"><a href="../reference/primitive_ticks.html">primitive_ticks</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="sandwiching">Sandwiching<a class="anchor" aria-label="anchor" href="#sandwiching"></a>
</h2>
<p>Aside from making a stack of primitives, we can also build a sandwich
of primitives. Analogous to two pieces of bread on the outside with the
good bits on the inside, a sandwich composition of guides often sees a
centrepiece flanked by two other guides.</p>
<p>Similar to how we naively believed <code><a href="https://ggplot2.tidyverse.org/reference/guide_axis_stack.html" class="external-link">guide_axis_stack()</a></code> to
be its own little snowflake of a guide, so too is
<code><a href="../reference/guide_colbar.html">guide_colbar()</a></code> in fact a composition:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="fu"><a href="../reference/guide_colbar.html">guide_colbar</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ComposeSandwich" "Compose"         "Guide"           "ggproto"        </span></span>
<span><span class="co">#&gt; [5] "gg"</span></span></code></pre></div>
<p>Focussing on the ‘bread’ part first, there are two guides we can use
for flanking the innards. One is called ‘text’ and the other one is
called ‘opposite’.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standard</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">cty</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_c</a></span><span class="op">(</span></span>
<span>    guide <span class="op">=</span> <span class="fu"><a href="../reference/compose_sandwich.html">compose_sandwich</a></span><span class="op">(</span></span>
<span>      text     <span class="op">=</span> <span class="fu"><a href="../reference/primitive_labels.html">primitive_labels</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>      opposite <span class="op">=</span> <span class="fu"><a href="../reference/primitive_ticks.html">primitive_ticks</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>They are called ‘text’ and ‘opposite’ because the ‘text’-guide will
take on the position indicated by the <code>legend.text.position</code>
theme element. Perhaps unsurprisingly; the guide at the other end is
called the ‘opposite’ guide. You can expose this by swapping the theme
element.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/last_plot.html" class="external-link">last_plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.text.position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>It should also be noted that if the guide has a label-supression
mechanism, the ‘opposite’ guide will be drawn with surpressed labels.
The mechanism is in place in guides like
<code><a href="https://ggplot2.tidyverse.org/reference/guide_axis.html" class="external-link">guide_axis()</a></code>/<code><a href="../reference/guide_axis_base.html">guide_axis_base()</a></code> for display in
for example <code>facet_grid(axis.labels = "margins")</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standard</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">cty</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_c</a></span><span class="op">(</span></span>
<span>    guide <span class="op">=</span> <span class="fu"><a href="../reference/compose_sandwich.html">compose_sandwich</a></span><span class="op">(</span></span>
<span>      text     <span class="op">=</span> <span class="st">"axis_base"</span>, </span>
<span>      opposite <span class="op">=</span> <span class="st">"axis_base"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># The same plot</span></span>
<span><span class="va">standard</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">cty</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_c</a></span><span class="op">(</span></span>
<span>    guide <span class="op">=</span> <span class="fu"><a href="../reference/guide_colbar.html">guide_colbar</a></span><span class="op">(</span>vanilla <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>The only thing that <code><a href="../reference/guide_colbar.html">guide_colbar()</a></code> does, that
<code><a href="../reference/compose_sandwich.html">compose_sandwich()</a></code> does not, is to adjust the theme
settings to match <code><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">ggplot2::guide_colourbar()</a></code> more
closely.</p>
<p>Alright, fine, I get the ‘bread’ part of the sandwich! What about the
inside? I’m glad you asked.</p>
</div>
<div class="section level2">
<h2 id="gizmos">Gizmos<a class="anchor" aria-label="anchor" href="#gizmos"></a>
</h2>
<p>The insides of the <code><a href="../reference/guide_colbar.html">guide_colbar()</a></code> is a so called
‘gizmo’. A gizmo differs from a primitive in that a gizmo is not a
general building block, but rather a specialised display of a particular
aesthetic. Also, it is not a complete guide as it does not allow you to
complete the crucial task of translating the graphic display into an
interpretation of data. It is called a ‘gizmo’ because it is sort of a
gadget that I don’t have a more appropriate name for. Hence: gizmo.</p>
<div class="section level3">
<h3 id="my-first-gizmo">My first gizmo<a class="anchor" aria-label="anchor" href="#my-first-gizmo"></a>
</h3>
<p>We can display only the gizmo from <code><a href="../reference/guide_colbar.html">guide_colbar()</a></code> —the
sandwich spread, if you will— as <code><a href="../reference/gizmo_barcap.html">gizmo_barcap()</a></code>. It is also
immediately clear why we need the bread in this case.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standard</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">cty</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_c</a></span><span class="op">(</span></span>
<span>    guide <span class="op">=</span> <span class="fu"><a href="../reference/gizmo_barcap.html">gizmo_barcap</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>Similarly <code><a href="../reference/guide_colsteps.html">guide_colsteps()</a></code> has
<code><a href="../reference/gizmo_stepcap.html">gizmo_stepcap()</a></code>, which might be the second gizmo you may
already have encountered.</p>
</div>
<div class="section level3">
<h3 id="exotic-gizmos">Exotic gizmos<a class="anchor" aria-label="anchor" href="#exotic-gizmos"></a>
</h3>
<p>There are also gizmos that may be less familiar. A reasonably simple
one is <code><a href="../reference/gizmo_grob.html">gizmo_grob()</a></code>, which just allows you to place a grob
in a guide. For example, we can stack it with an axis, or use it as the
non-bread part of a sandwich. Please note that this is <em>not</em> a
good representation of the plot’s colour aesthetic. I hope this wouldn’t
have been necessary but: don’t make your plot like this!</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_grob</span> <span class="op">&lt;-</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">grobTree</a></span><span class="op">(</span></span>
<span>  <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.rect.html" class="external-link">rectGrob</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">textGrob</a></span><span class="op">(</span><span class="st">"Grob\nGizmo"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">my_gizmo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gizmo_grob.html">gizmo_grob</a></span><span class="op">(</span><span class="va">my_grob</span>, width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"cm"</span><span class="op">)</span>, height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">standard</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">cty</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="../reference/compose_stack.html">compose_stack</a></span><span class="op">(</span><span class="st">"axis"</span>, <span class="va">my_gizmo</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="fu"><a href="../reference/compose_sandwich.html">compose_sandwich</a></span><span class="op">(</span>middle <span class="op">=</span> <span class="va">my_gizmo</span>, text <span class="op">=</span> <span class="st">"axis_base"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>Perhaps some gizmo’s that are inherently more useful are
<code><a href="../reference/gizmo_density.html">gizmo_density()</a></code> and <code><a href="../reference/gizmo_histogram.html">gizmo_histogram()</a></code>. By
default, these wrap the <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">density()</a></code> and <code><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist()</a></code>
functions that are then called on the layer’s data. You can pass
arguments to these functions with the <code>density.args</code> and
<code>hist.args</code> respectively. But I’ll repeat again: these are
gizmos, not full guides. Also: please ignore that we’re guiding both
<code>colour</code> and <code>fill</code> while only <code>colour</code>
is visible.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standard</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">cty</span>, fill <span class="op">=</span> <span class="va">cty</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_c</a></span><span class="op">(</span></span>
<span>    option <span class="op">=</span> <span class="st">"C"</span>,</span>
<span>    guide <span class="op">=</span> <span class="fu"><a href="../reference/gizmo_density.html">gizmo_density</a></span><span class="op">(</span>density.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adjust <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span></span>
<span>    option <span class="op">=</span> <span class="st">"D"</span>,</span>
<span>    guide <span class="op">=</span> <span class="fu"><a href="../reference/gizmo_histogram.html">gizmo_histogram</a></span><span class="op">(</span>hist.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>However, you can easily promote these gizmos to full guide by adding
an axis. The <code><a href="../reference/compose_sandwich.html">compose_sandwich()</a></code> can do a reasonable job for
this.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standard</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">cty</span>, fill <span class="op">=</span> <span class="va">cty</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_c</a></span><span class="op">(</span></span>
<span>    option <span class="op">=</span> <span class="st">"C"</span>,</span>
<span>    guide <span class="op">=</span> <span class="fu"><a href="../reference/compose_sandwich.html">compose_sandwich</a></span><span class="op">(</span></span>
<span>      middle <span class="op">=</span> <span class="fu"><a href="../reference/gizmo_density.html">gizmo_density</a></span><span class="op">(</span>just <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>      text <span class="op">=</span> <span class="st">"axis_base"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span></span>
<span>    option <span class="op">=</span> <span class="st">"D"</span>,</span>
<span>    guide <span class="op">=</span> <span class="fu"><a href="../reference/compose_sandwich.html">compose_sandwich</a></span><span class="op">(</span></span>
<span>      middle <span class="op">=</span> <span class="fu"><a href="../reference/gizmo_histogram.html">gizmo_histogram</a></span><span class="op">(</span>just <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>      text <span class="op">=</span> <span class="st">"axis_base"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="other-compositions">Other compositions<a class="anchor" aria-label="anchor" href="#other-compositions"></a>
</h2>
<p>The following compositions are more situational and aren’t part of
any ‘proper’ guide. The <code><a href="../reference/compose_ontop.html">compose_ontop()</a></code> guide lets you
render one guide over the other. We can see in the plots below that it
allows us to touch the panel when composing on top of one another, but
not when stacking.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/guide_axis_base.html">guide_axis_base</a></span><span class="op">(</span></span>
<span>  key <span class="op">=</span> <span class="fu"><a href="../reference/key_standard.html">key_manual</a></span><span class="op">(</span><span class="fl">32</span>, label <span class="op">=</span> <span class="st">"Here is 32"</span><span class="op">)</span>,</span>
<span>  theme <span class="op">=</span> <span class="fu"><a href="../reference/theme_guide.html">theme_guide</a></span><span class="op">(</span></span>
<span>    ticks.length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">standard</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>y.sec <span class="op">=</span> <span class="fu"><a href="../reference/compose_ontop.html">compose_ontop</a></span><span class="op">(</span><span class="st">"axis"</span>, <span class="va">top</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"compose_ontop"</span><span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standard</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>y.sec <span class="op">=</span> <span class="fu"><a href="../reference/compose_stack.html">compose_stack</a></span><span class="op">(</span><span class="st">"axis"</span>, <span class="va">top</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"compose_stack"</span><span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-19-2.png" width="700"></p>
<p>There is also <code><a href="../reference/compose_crux.html">compose_crux()</a></code> (or ‘cross’) that is the
parent composition of <code><a href="../reference/compose_sandwich.html">compose_sandwich()</a></code>. Instead only
allowing bread on two sides, it can also put guides on the top and
bottom. It isn’t currently in use by any complete guide though.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ball</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gizmo_grob.html">gizmo_grob</a></span><span class="op">(</span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.circle.html" class="external-link">circleGrob</a></span><span class="op">(</span></span>
<span>  r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span>, gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gizmo_grob.html">gizmo_grob</a></span><span class="op">(</span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.rect.html" class="external-link">rectGrob</a></span><span class="op">(</span></span>
<span>  width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"cm"</span><span class="op">)</span>, height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"cm"</span><span class="op">)</span>, </span>
<span>  gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"dodgerblue"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">standard</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">cty</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_c</a></span><span class="op">(</span></span>
<span>    guide <span class="op">=</span> <span class="fu"><a href="../reference/compose_crux.html">compose_crux</a></span><span class="op">(</span></span>
<span>      centre <span class="op">=</span> <span class="fu"><a href="../reference/gizmo_barcap.html">gizmo_barcap</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>      left <span class="op">=</span> <span class="st">"axis_base"</span>, right <span class="op">=</span> <span class="st">"axis_base"</span>,</span>
<span>      top <span class="op">=</span> <span class="va">ball</span>, bottom <span class="op">=</span> <span class="va">block</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="guide_composition_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Teun van den Brand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
